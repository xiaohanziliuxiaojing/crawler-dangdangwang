# coding: utf-8
from bs4 import BeautifulSoup
import os
import urllib
import requests
import re
import json
import pandas as pd
from pandas import DataFrame,Series
import xlsxwriter

shu = ['493776',
'9206992',
'9053948',
'9206995',
'9053932',
'9274514',
'9274511',
'9274512',
'9274516',
'9274513',
'9274515',
'9239112',
'9239127',
'9239122',
'9239125',
'9239114',
'9239115',
'9239116',
'9239119',
'9239123',
'8777060',
'8777059',
'8777061',
'8777062',
'9025203',
'9225651',
'9225654',
'9295679',
'9295695',
'9295687',
'9295661',
'9295702',
'8784314',
'8784311',
'8784316',
'8784312',
'8784315',
'8784310',
'8877701',
'8877705',
'9353334',
'9353324',
'9353323',
'26918636',
'26918637',
'23630883',
'23709537',
'22915838',
'25210260',
'25203459',
'22568812',
'22547422',
'23987457',
'22796795',
'25224684',
'22547421',
'22860079',
'22860075',
'22860077',
'24105869',
'25274230',
'23565295',
'25274235',
'23595284',
'24058337',
'25274233',
'25336702',
'23716066',
'23716064',
'22627448',
'22627446',
'22627451',
'22627452',
'25327988',
'25327987',
'25268464',
'23403417',
'23901884',
'23902033',
'23901988',
'23901883',
'23410453',
'22622686',
'22622684',
'22622685',
'22622683',
'22622681',
'22622680',
'22622679',
'22622678',
'22622677',
'22622676',
'23941957',
'23710660',
'24167666',
'23918257',
'24010587',
'24010589',
'24010588',
'24007241',
'24007242',
'23819095',
'24142741',
'24142744',
'24106090',
'24142745',
'24106093',
'24106089',
'24142742',
'24142743',
'24106092',
'23666086',
'23666089',
'23666092',
'23666088',
'23666090',
'23666091',
'23666093',
'23666087',
'24170340',
'23763869',
'25314781',
'26908534',
'23592972',
'23827567',
'24016931',
'24016930',
'23720333',
'23522654',
'23579072',
'23291782',
'23387494',
'23343460',
'23314715',
'23496226',
'25254295',
'23579917',
'23838232',
'23940348',
'23984462',
'23496222',
'23817233',
'23790744',
'23838798',
'23838229',
'23801831',
'23801832',
'25254313',
'25254310',
'25254314',
'25254312',
'25254311',
'25254315',
'25254316',
'23763126',
'23763127',
'23604583',
'25078294',
'20831348',
'23807637',
'23442535',
'22573522',
'25214826',
'25230329',
'25069962',
'25070178',
'25069500',
'25070176',
'25070183',
'25070175',
'25070181',
'25070182',
'25070184',
'25078298',
'25070177',
'25152546',
'25326243',
'25069498',
'24058463',
'24058485',
'24058486',
'22923252',
'20284490',
'22554297',
'22554296',
'22554294',
'23464321',
'25091370',
'25091371',
'20598222',
'25110998',
'23410250',
'25094132',
'23394356',
'24020718',
'22635158',
'23456501',
'25091366',
'25091372',
'25070174',
'25070180',
'25230517',
'23725004',
'23831400',
'23444556',
'27866091',
'25347232',
'23322689',
'23444558',
'23354578',
'25076232',
'23810026',
'24035773',
'24005668',
'23521579',
'24242871',
'23465214',
'22781411',
'23344991',
'25069944',
'25351917',
'23677690',
'23801195',
'23735265',
'23748529',
'24160917',
'23994792',
'24181972',
'25280106',
'25283922',
'23954624',
'23790829',
'24035424',
'23615070',
'23998884',
'23462458',
'23403277',
'25290864',
'25163899',
'25163898',
'25163895',
'25163896',
'25163894',
'25163893',
'25163897',
'24155400',
'24155402',
'24155401',
'24155403',
'24155404',
'24155405',
'24155407',
'24155406',
'24155408',
'20128322',
'20128319',
'20128318',
'20128327',
'20128326',
'20128323',
'20128325',
'20128320',
'20615057',
'20615060',
'20615062',
'20615061',
'20615059',
'20615056',
'20615058',
'22582523',
'22582527',
'22582526',
'22582529',
'22592328',
'26488037',
'25348119',
'25348089',
'23168749',
'23168733',
'23168734',
'23225303',
'23225302',
'23225298',
'25348113',
'23225300',
'25348115',
'23440403',
'23440401',
'23440402',
'23440398',
'23440400',
'23440399',
'23544519',
'23544516',
'23544518',
'23544512',
'23576192',
'23576193',
'23767490',
'23767491',
'23767492',
'23767489',
'23833065',
'23833061',
'23833062',
'23833066',
'23833064',
'23833063',
'24167324',
'24167323',
'24167322',
'24167326',
'24167317',
'24167325',
'24167318',
'22655990',
'22655988',
'22655992',
'22655994',
'22655995',
'23168727',
'23168728',
'23168730',
'25271135',
'23295365',
'23405710',
'23405711',
'23405712',
'23561633',
'23670450',
'23670451',
'23954602',
'25346114',
'25346111',
'25346117',
'23464185',
'23464186',
'23464187',
'23802046',
'23802043',
'23802049',
'23802051',
'24018984',
'24018879',
'24018908',
'24018979',
'24018927',
'24018981',
'23896167',
'23839012',
'23839013',
'24028362',
'24028363',
'24028361',
'23839014',
'20560100',
'20560098',
'20560099',
'20560091',
'20560097',
'20560093',
'20560092',
'20560095',
'21037539',
'21037541',
'21037540',
'21037542',
'21037543',
'21037545',
'21037544',
'21037546',
'23879568',
'23879361',
'23879648',
'23879650',
'23872399',
'23872400',
'23872401',
'23397002',
'23872410',
'23872406',
'23872407',
'23872404',
'23872405',
'23872403',
'22778723',
'22778724',
'22778725',
'22778726',
'22778727',
'22778728',
'22778729',
'22778730',
'22778731',
'22778732',
'23677719',
'23677724',
'23677720',
'23677721',
'23677717',
'23872951',
'23872953',
'23872949',
'23872954',
'23872950',
'23872952',
'23604614',
'23604615',
'23604616',
'23604618',
'23999213',
'23999214',
'27849290',
'23999215',
'23999216',
'23999217',
'23999211',
'23413793',
'23648712',
'23749987',
'23604681',
'23604682',
'23604683',
'23604684',
'23604685',
'23604686',
'23708938',
'23708943',
'23708949',
'23708948',
'24040899',
'24040900',
'24040901',
'24040902',
'24040886',
'24040887',
'20500499',
'20689449',
'20689451',
'20689450',
'21071469',
'20689448',
'23760362',
'23489998',
'23870665',
'23870666',
'23870667',
'23870668',
'23870669',
'23870670',
'23870672',
'23870673',
'23870671',
'25084926',
'24106492',
'23634506',
'23221999',
'23222019',
'25251686',
'23446986',
'22931977',
'23446988',
'26486125',
'23590750',
'23398484',
'26437068',
'23446990',
'23446991',
'23522520',
'25343136',
'23522519',
'23398483',
'26486123',
'23704482',
'24039902',
'25264680',
'27902550',
'23760439',
'26514700',
'27878009',
'23923448',
'23794639',
'25246337',
'23475700',
'27920902',
'25302892',
'22616514',
'23184346',
'22936848',
'20022172',
'25572754',
'23416378',
'23409631',
'25808513',
'23741556',
'23217261',
'26244749',
'23178543',
'23178734',
'23178539',
'23178541',
'22733470',
'22733471',
'22733467',
'22733469',
'22733468',
'21035829',
'21035840',
'21035828',
'21035831',
'21035830',
'23490660',
'23490659',
'23490661',
'23490657',
'23558406',
'23558402',
'23558405',
'23558403',
'23558404',
'23973068',
'23973067',
'23973066',
'24073155',
'23326894',
'23326900',
'23326895',
'23326896',
'23326897',
'23326899',
'23326898',
'22848255',
'24170869',
'22616512',
'24019534',
'23785690',
'23786102',
'23786108',
'23786103',
'23786105',
'23786101',
'23786106',
'23786107',
'23786104',
'23786100',
'25251980',
'25260170',
'23459303',
'25269527',
'23470282',
'25086241',
'24167477',
'25312478',
'25312479',
'25312480',
'25290159',
'23535952',
'23588714',
'24034149',
'23791286',
'24224415',
'23667867',
'24058899',
'23927757',
'23633724',
'23633723',
'22855849',
'23929045',
'23664441',
'23764162',
'23764164',
'23903143',
'23815587',
'23470366',
'25296715',
'23700515',
'22791386',
'23901570',
'23901681',
'24035073',
'25083679',
'23844336',
'20632437',
'20632436',
'23825534',
'23825536',
'23718469',
'22725936',
'23860630',
'23860629',
'25100748',
'24164006',
'23588716',
'23741769',
'23692933',
'25282301',
'24145345',
'24175626',
'24175625',
'24175628',
'24176224',
'24175627',
'25248421',
'25229912',
'25229913',
'25285539',
'27892119',
'20435314',
'20435311',
'26511306',
'24159165',
'23304704',
'24159175',
'23836803',
'25248427',
'25276992',
'25210241',
'25309340',
'25203489',
'24159177',
'24159179',
'25203476',
'25224652',
'25224654',
'20528891',
'24159173',
'25285538',
'25203517',
'23704698',
'25285533',
'25320802',
'25274221',
'20705304',
'25297596',
'25285591',
'25310093',
'25274222',
'25195968',
'25309330',
'23836827',
'26511305',
'25248407',
'25285536',
'25297593',
'25320818',
'25320815',
'25203514',
'26907946',
'20781511',
'20781512',
'22915836',
'22915843',
'25203516',
'25248420',
'25285488',
'25297595',
'27883002',
'26511294',
'25285501',
'25203494',
'22574764',
'24159167',
'25320806',
'25203491',
'22807961',
'21093258',
'23644602',
'23605760',
'20988029',
'20354545',
'25276961',
'20382373',
'26511304',
'20991013',
'25274224',
'25274223',
'25248428',
'25250870',
'25250871',
'25285483',
'25250868',
'25272255',
'25250869',
'25224650',
'20863207',
'21036373',
'25195964',
'25195967',
'25276988',
'25285545',
'25248419',
'24159171',
'25297555',
'25309331',
'24159169',
'21047236',
'25224649',
'25309341',
'27883274',
'20863211',
'20533037',
'20533035',
'20533041',
'20911644',
'25276962',
'25248418',
'25285589',
'26483883',
'25285542',
'20081493',
'25297586',
'25297584',
'20039362',
'23453776',
'22600665',
'20354548',
'23381720',
'25309359',
'25297597',
'25285537',
'25276963',
'25285587',
'25309343',
'20081494',
'23605759',
'25274228',
'25276959',
'22907993',
'25276966',
'22907998',
'22765236',
'23238611',
'25203513',
'25276990',
'25285451',
'25250860',
'25250863',
'25297594',
'22765238',
'23367037',
'26511303',
'21080122',
'23367032',
'23367034',
'23367033',
'23367029',
'22725721',
'24057690',
'27883674',
'22707408',
'23867851',
'23867850',
'23867855',
'23867854',
'23867852',
'23861565',
'23861566',
'23861563',
'23861564',
'23861562',
'23861567',
'20973812',
'20973814',
'23600650',
'23460297',
'23398249',
'23689619',
'23437075',
'27884496',
'27884497',
'27884474',
'27884475',
'27884498',
'27884480',
'27884476',
'27884479',
'20986036',
'27884478',
'25220873',
'20794962',
'25220872',
'20097600',
'20466630',
'20466629',
'20794964',
'20794963',
'20794965',
'25220874',
'20097601',
'20097602',
'20466633',
'20097599',
'27884618',
'27884589',
'27884615',
'27884590',
'27884614',
'23868159',
'25290528',
'23893294',
'23892955',
'27851057',
'25585227',
'23892952',
'23893297',
'26909599',
'23893228',
'27902480',
'26909600',
'27902503',
'26909601',
'23968268',
'27884202',
'26909602',
'23654848',
'22607178',
'23654843',
'23654850',
'23654845',
'23654847',
'23654846',
'27884584',
'27884586',
'27884585',
'27902018',
'27884583',
'27902022',
'20763978',
'23636484',
'20457833',
'23271284',
'25108090',
'23743932',
'23743931',
'24010503',
'24007001',
'25283514',
'20387252',
'22610208',
'22610207',
'22610206',
'23486369',
'23514994',
'23514995',
'23514993',
'23533681',
'23535867',
'23963390',
'24007380',
'24044162',
'23755237',
'23756339',
'23930087',
'23778717',
'23485740',
'23612361',
'23624291',
'23509396',
'23557290',
'23485739',
'20220631',
'23509395',
'22480611',
'20420790',
'21086028',
'20759236',
'25163150',
'22886328',
'25163145',
'20797502',
'23194028',
'22609636',
'22492096',
'25155947',
'21100346',
'21086027',
'20187025',
'23509394',
'20220632',
'20196115',
'23753891',
'23778715',
'24144605',
'24144609',
'23485741',
'22886329',
'22815739',
'22715329',
'20948665',
'20599505',
'20652142',
'20186863',
'22840873',
'23462267',
'20622624',
'23196841',
'21031204',
'23219906',
'23417886',
'22927872',
'20745959',
'23929862',
'23822240',
'23791431',
'23903130',
'22609638',
'22715326',
'20759235',
'20991811',
'21126260',
'22576779',
'23685393',
'23728627',
'23617271',
'23676222',
'22609640',
'22841309',
'23509397',
'23585697',
'23456022',
'23456029',
'23477272',
'23676224',
'23778718',
'22789291',
'23300030',
'23407417',
'20315842',
'22886330',
'23509400',
'24144606',
'20560434',
'25163138',
'25163147',
'25163121',
'20315845',
'20574334',
'22542614',
'22907205',
'23300032',
'20765631',
'23618702',
'23931313',
'23981996',
'20734971',
'20738463',
'20460673',
'20599504',
'25163143',
'25155948',
'20220614',
'20363595',
'20363594',
'22886326',
'20460675',
'20460674',
'20658567',
'20738462',
'20742809',
'20797504',
'20797508',
'23907116',
'20849487',
'20887671',
'20900280',
'20948666',
'20990684',
'21074089',
'22572873',
'22576785',
'22576786',
'22715325',
'22927870',
'23194027',
'23194029',
'23196842',
'23285358',
'23295447',
'23295451',
'23295453',
'23331332',
'23407419',
'23401724',
'23456025',
'23456023',
'23600995',
'23604807',
'23946645',
'23919482',
'23981997',
'23945954',
'24158055',
'24158053',
'24158056',
'24158057',
'24196907',
'24196908',
'24158054',
'25092357',
'25084838',
'20460672',
'22542615',
'22576789',
'22886327',
'22609641',
'20068784',
'20084090',
'20797505',
'20797506',
'20797507',
'20797509',
'20819622',
'20825404',
'21074090',
'21074091',
'21086024',
'22715324',
'22815740',
'22913903',
'23331329',
'23745342',
'23790346',
'25092377',
'25346622',
'23838544',
'25349968',
'27871550',
'26511094',
'23324086',
'25480958',
'22527856',
'25265348',
'25265346',
'25573590',
'26436953',
'26436909',
'25329257',
'25351545',
'25063388',
'24194389',
'23536544',
'23767677',
'26918419',
'23746384',
'23746380',
'23746383',
'23606695',
'23606697',
'23606698',
'25160735',
'23338493',
'25480964',
'23235667',
'23298599',
'26439823',
'20944461',
'23324088',
'23338482',
'24028328',
'24028329',
'26316046',
'21000849',
'23338481',
'26436966',
'20763256',
'20763255',
'20763257',
'24180821',
'25480961',
'23574393',
'23492340',
'20345191',
'20345192',
'20978513',
'20978516',
'23524975',
'25154388',
'25154390',
'23380235',
'25319627',
'25327717',
'23287308',
'23312486',
'23338489',
'23365650',
'23380234',
'24039941',
'23338479',
'22612320',
'23735388',
'23735387',
'23338487',
'26917426',
'26914248',
'26491981',
'24013350',
'23492341',
'26907958',
'23574390',
'23324090',
'27889899',
'25336326',
'23721386',
'23721385',
'23383097',
'22786241',
'22823863',
'22900944',
'22900943',
'22818836',
'22900941',
'23693912',
'22818832',
'22818837',
'22900945',
'22818835',
'23693911',
'23693910',
'22818833',
'22900942',
'23693908',
'23693909',
'23693907',
'22900940',
'23693902',
'22818834',
'23693903',
'23757095',
'23757093',
'23757090',
'23757089',
'23757092',
'23249896',
'23249892',
'23249897',
'23249894',
'23249893',
'23249895',
'23505907',
'23505903',
'23505902',
'23505906',
'23505904',
'23757094',
'23851404',
'23851406',
'23851405',
'23851408',
'23851407',
'23254614',
'23592468',
'23999914',
'23999912',
'24101008',
'24101007',
'23693915',
'23693916',
'24198385',
'24198384',
'24101009',
'24101010',
'23952924',
'23952922',
'23792854',
'23693919',
'23693918',
'25065864',
'20545129',
'20545128',
'20545130',
'24165588',
'24040198',
'22765774',
'22765777',
'24102001',
'23875979',
'27894943',
'23923987',
'23923985',
'23923986',
'25346144',
'25346294',
'25346141',
'25346293',
'25346133',
'25346136',
'25346145',
'25346295',
'25346139',
'25346137',
'25346140',
'25346297',
'25346142',
'25346296',
'25346135',
'25346143',
'25346138',
'25346134',
'23540612',
'23408907',
'23471710',
'23408908',
'23314868',
'23188216',
'22820234',
'22731449',
'23188217',
'22858946',
'20678779',
'22908699',
'23800081',
'23800082',
'26439393',
'23815815',
'23815814',
'23721664',
'23774273',
'23365536',
'23617432',
'23363494',
'23363495',
'23363510',
'23363500',
'23363504',
'23363496',
'23719980',
'23363501',
'23363512',
'23363505',
'23363493',
'23363511',
'23363498',
'23363509',
'23363499',
'23363507',
'25313741',
'25313730',
'25313738',
'25313740',
'23960072',
'25313729',
'25313732',
'25313736',
'25313733',
'23960066',
'23960061',
'25313734',
'25225867',
'25323029',
'25323034',
'25332305',
'25234510',
'25225865',
'22680639',
'22680637',
'22680636',
'25093211',
'25248008',
'23291840',
'25344855',
'27892289',
'25323040',
'20624752',
'25323043',
'26918034',
'21033404',
'20403332',
'25248003',
'25323031',
'25225866',
'25234509',
'21033406',
'25248002',
'25306719',
'25234512',
'25248004',
'25227242',
'25218540',
'25306720',
'25234508',
'25288215',
'25306726',
'25352088',
'25306729',
'23923399',
'27868071',
'25266753',
'25352083',
'23289784',
'23818754',
'25352085',
'22870353',
'25266735',
'25248005',
'23832687',
'25227339',
'27856492',
'23225560',
'25288207',
'27868069',
'25266741',
'20430025',
'25254720',
'25227338',
'25234514',
'25225863',
'25254721',
'23505431',
'24017017',
'25227340',
'24030506',
'21033409',
'24080007',
'23656386',
'24181495',
'25065795',
'24181490',
'25323037',
'23901127',
'20769269',
'24010182',
'23656387',
'23656385',
'23818753',
'20468756',
'22923552',
'22923551',
'22923554',
'22923558',
'22923561',
'22923553',
'22923565',
'22923559',
'22923560',
'22923556',
'22923562',
'22923564',
'22923555',
'22923548',
'22923557',
'22923547',
'22680592',
'24010187',
'20819173',
'23825113',
'23615152',
'23461606',
'22542403',
'23353915',
'22486637',
'25169361',
'23382415',
'23373814',
'23382416',
'23382417',
'23373812',
'23382413',
'23382414',
'23373813',
'23464532',
'23464534',
'23464533',
'23464531',
'23464530',
'23464529',
'23464528',
'23464527',
'23464526',
'23464525',
'23354404',
'23259661',
'23702378',
'24144209',
'24144212',
'24144211',
'24144210',
'24144215',
'24144213',
'24028666',
'24049714',
'23827552',
'24207997',
'24049729',
'23434263',
'24028638',
'23827556',
'25584462',
'25301114',
'25809729',
'24011496',
'25301116',
'23917644',
'23775290',
'23193524',
'24011495',
'23617694',
'23467236',
'23396307',
'23978251',
'23574800',
'24156621',
'23971200',
'23929064',
'23928963',
'25809266',
'25301115',
'23059569',
'24225188',
'23917643',
'23917640',
'23917632',
'23917647',
'23602836',
'24104120',
'23171395',
'23171396',
'25301221',
'23171392',
'23472437',
'26314588',
'26917121',
'23617696',
'23574808',
'23767737',
'25250127',
'25189769',
'23424409',
'23340865',
'25301124',
'25249970',
'23424407',
'23288496',
'23288497',
'23865237',
'23865238',
'23865235',
'23865234',
'25176229',
'23424413',
'23171386',
'23302661',
'23727249',
'23574801',
'23651827',
'23630831',
'26919386',
'23671450',
'25301218',
'23235446',
'23574802',
'25240908',
'25284914',
'23424410',
'23574805',
'23574804',
'23574803',
'23651831',
'24156609',
'23811609',
'23630830',
'20179691',
'20179693',
'20179694',
'20179695',
'20179696',
'20179697',
'20179698',
'20179699',
'20179700',
'23831316',
'23831321',
'23831319',
'23831318',
'23997213',
'23997215',
'23887288',
'23955439',
'27860080',
'27860070',
'25240093',
'25268457',
'25240100',
'23600690',
'25176259',
'25176260',
'23305673',
'22800945',
'22621783',
'22621781',
'22621792',
'22621785',
'22621800',
'22621798',
'22621799',
'22621796',
'22621794',
'23813712',
'22518209',
'23714253',
'23417705',
'22770145',
'23931107',
'23200283',
'23941960',
'24010585',
'24157228',
'23280407',
'23631916',
'23424987',
'24024289',
'23807308',
'22805659',
'23829427',
'25069495',
'23955323',
'25070171',
'24042936',
'24167057',
'23727176',
'22545142',
'25070173',
'25319532',
'22554298',
'25091368',
'25089703',
'22550653',
'23168354',
'27855287',
'25069493',
'23270635',
'24185768',
'24185767',
'25235751',
'25326783',
'25329085',
'25338390',
'25338391',
'25348108',
'25348107',
'25353534',
'23444370',
'23558597',
'23589183',
'23680863',
'23767471',
'23883471',
'24169752',
'25243246',
'26515567',
'23168742',
'23302256',
'23405702',
'23591872',
'23680864',
'25092722',
'25809548',
'23808035',
'24170507',
'23578095',
'23909210',
'25312473',
'20366131',
'23670056',
'23422457',
'23347520',
'23193099',
'23486740',
'23261061',
'23231947',
'22762205',
'25156076',
'24040911',
'23461615',
'23497978',
'23999212',
'23745288',
'24024433',
'23708947',
'24040905',
'24040889',
'24046302',
'24169643',
'25081200',
'24194983',
'23691774',
'24057772',
'24057773',
'24057771',
'24057770',
'24021981',
'25309848',
'25309847',
'25309849',
'23433903',
'23604744',
'23542083',
'27889889',
'20039611',
'23663880',
'26490594',
'25325228',
'22936843',
'23524999',
'23662844',
'22820958',
'25315049',
'26516107',
'23318861',
'24036799',
'23450232',
'23465652',
'20628076',
'23262983',
'22844902',
'23790038',
'23790037',
'25084417',
'26916076',
'27892216',
'24167474',
'25248070',
'23796863',
'22808382',
'24047106',
'24147342',
'24178074',
'20719765',
'20714820',
'20811232',
'20841324',
'20849322',
'21036203',
'21078672',
'22529197',
'22641750',
'22725911',
'23225767',
'23349343',
'25212006',
'23556988',
'22582742',
'23038956',
'25152655',
'23593910',
'25480195',
'24221823',
'23701823',
'23840213',
'23654851',
'24007377',
'25228609',
'20763983',
'24011379',
'24028632',
'23431590',
'23633693',
'26482848',
'23365769',
'25289538',
'24000406',
'24079906',
'25319757',
'27868567',
'25289522',
'26437070',
'20976736',
'23591527',
'22930195',
'25325493',
'24099337',
'23254613',
'23806760',
'23999911',
'24101003',
'23693917',
'24198383',
'23693920',
'24036752',
'25310278',
'23450686',
'24014017',
'25246666',
'25342352',
'23227311',
'25325254',
'23459373',
'21041979',
'23382442',
'25159441',
'24143741',
'23617722',
'23192842',
'23965654',
'23711974',
'23711975',
'23711976',
'25299672',
'23940063',
'23999613',
'22617140',
'23268441'
]


header = {'User-Agent': "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"}

file = "F:/dangdang/第一批/zuozhe"

def makedirs(path):  
		folder = os.path.exists(path)#判断路径下文件夹是否存在
		if not folder:
			os.makedirs(path)#mkdir 和 makedirs
			print ("picture文件夹创建成功") 
		else:  
			print ("picture文件夹已经存在")  

def run_makedirs():
	makedirs(file) 

run_makedirs()

def get_sn_bianma(Referer,header):#抓取sn编码
	try:
		html = requests.get(Referer,headers = header)
		soup_first = BeautifulSoup(html.text,'lxml')
		list_third = soup_first.find('div',class_='pro_content')
		soup_four = list_third.find_all('li')[4]
		ret = re.findall(r'\d*',soup_four.get_text())#编码
		return ret[11]
		#ret_list.append(ret[11])
	except Exception as err:
		fillte='导出失败:'+str(err)
		print(fillte)
	else:
		succefull='--------sn编码：打印成功---------'
		print(succefull)

#**************************************************************************************************************************************
#Referer = 'http://product.dangdang.com/25342352.html'
list_dongxi2 = []
aa = ['sn编码','作者简介','出版社','出版时间','几颗星','评论数','价格','包装']
list_dongxi2.append(aa)
def Gethref(Referer,header):#抓取作者
	try:
		list_dongxi = []
		html = requests.get(Referer,headers = header)
		soup_first = BeautifulSoup(html.text,'lxml')
		list_dongxi.append(get_sn_bianma(Referer,header))#添加sn编码
		list_first = soup_first.find('div',class_='messbox_info')
		soup_1 = list_first.find('span',class_='t1',id="author")
		soup_2 = list_first.find('span',class_='t1',dd_name="出版社")
		soup_3 = list_first.find_all('span',class_='t1')[2]
		soup_4 = list_first.find_all('span',class_='t1')[4]
		soup_5 = list_first.find('span',class_ = "star")
		soup_6 = soup_first.find('div',class_ = "price_m",id = "original-price")
		list_dongxi.append(soup_1.get_text().split(":")[1])#作者简介
		list_dongxi.append(soup_2.get_text().split(":")[1])#出版社
		list_dongxi.append(soup_3.get_text().split(":")[1].replace('\xa0',''))#出版时间
		list_dongxi.append(soup_5['style'].split(":")[1])#添加几颗星
		list_dongxi.append(soup_4.get_text().replace("\n","").replace("\r","").strip())#评论数
		list_dongxi.append(soup_6.get_text())
		list_third = soup_first.find('div',class_='pro_content')
		soup_third = list_third.find_all('li')[2]
		list_dongxi.append(soup_third.get_text().split("：")[1])#添加装订 
		list_dongxi2.append(list_dongxi)
	except Exception as err:
		fillte='导出失败:'+str(err)
		print(fillte)
	else:
		succefull='--------' + i + '作者信息添加成功---------'
		print(succefull)


#**************先添加后导出**************************
#list_dongxi填充作者信息
for i in shu:
	Referer = 'http://product.dangdang.com/'+str(i)+'.html'
	Gethref(Referer,header)#抓取作者

def to_save():
	try:
		os.getcwd()
		os.chdir("F:/dangdang/第一批/zuozhe")
		workbook = xlsxwriter.Workbook('作者.xlsx')#新建excel
		worksheet = workbook.add_worksheet()#新建sheet
		for j in range(0, len(list_dongxi2)):
			worksheet.write_row('A' + str(j + 1), list_dongxi2[j])
		workbook.close()
	except Exception as err:
		fillte='导出失败:'+str(err)
		print(fillte)
	else:
		succefull='**********'+'作者内容导出成功**********'
		print(succefull)

to_save()

